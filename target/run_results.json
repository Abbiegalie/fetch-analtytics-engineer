{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.3", "generated_at": "2025-03-18T14:48:53.684580Z", "invocation_id": "ec661e6c-fbe9-47cb-9108-2661ecd86836", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-18T14:48:52.230153Z", "completed_at": "2025-03-18T14:48:52.241706Z"}, {"name": "execute", "started_at": "2025-03-18T14:48:52.242083Z", "completed_at": "2025-03-18T14:48:53.481261Z"}], "thread_id": "Thread-1", "execution_time": 1.2522799968719482, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb1798-0000-ca3c-0000-00015dbe84dd"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.fetch_analytics.fct_receipt_status", "compiled": true, "compiled_code": "\n\nwith receipt_metrics as (\n    select\n        rewards_receipt_status,\n        \n        -- Handle potential parsing issues with total_spent\n        try_cast(total_spent as decimal(18,2)) as parsed_total_spent,\n        \n        purchased_item_count\n    from RAW.PUBLIC_staging.staging_receipts\n    where \n        -- Filter for accepted/rejected receipts\n        rewards_receipt_status in ('FINISHED', 'REJECTED')\n        \n        -- Ensure data quality\n        and total_spent is not null\n        and purchased_item_count is not null\n)\n\nselect\n    rewards_receipt_status,\n    \n    -- Average spend metrics\n    avg(parsed_total_spent) as avg_total_spent,\n    \n    -- Count metrics\n    sum(purchased_item_count) as total_items_purchased,\n    count(*) as receipt_count,\n    \n    -- Derived metrics\n    sum(parsed_total_spent) as total_spent,\n    sum(parsed_total_spent) / sum(purchased_item_count) as avg_item_price\nfrom receipt_metrics\ngroup by rewards_receipt_status\norder by rewards_receipt_status", "relation_name": "RAW.PUBLIC.fct_receipt_status", "batch_results": null}], "elapsed_time": 2.8891959190368652, "args": {"exclude": [], "log_format_file": "debug", "print": true, "require_resource_names_without_spaces": false, "macro_debugging": false, "require_explicit_package_overrides_for_builtin_materializations": true, "require_yaml_configuration_for_mf_time_spines": false, "state_modified_compare_more_unrendered_values": false, "log_level_file": "debug", "log_format": "default", "log_path": "/Users/abbiegalie/fetch-analytics-project/logs", "strict_mode": false, "select": ["fct_receipt_status"], "defer": false, "warn_error_options": {"include": [], "exclude": []}, "printer_width": 80, "profiles_dir": "/Users/abbiegalie/fetch-analytics-project", "project_dir": "/Users/abbiegalie/fetch-analytics-project", "static_parser": true, "use_colors_file": true, "state_modified_compare_vars": false, "show_resource_report": false, "which": "run", "write_json": true, "send_anonymous_usage_stats": true, "vars": {}, "source_freshness_run_project_hooks": false, "introspect": true, "cache_selected_only": false, "require_batched_execution_for_custom_microbatch_strategy": false, "empty": false, "favor_state": false, "partial_parse": true, "indirect_selection": "eager", "require_nested_cumulative_type_params": false, "partial_parse_file_diff": true, "invocation_command": "dbt run --select fct_receipt_status", "log_level": "info", "log_file_max_bytes": 10485760, "use_colors": true, "skip_nodes_if_on_run_start_fails": false, "version_check": true, "populate_cache": true, "quiet": false}}